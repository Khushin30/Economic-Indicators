% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Economic Indicators analysis},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Economic Indicators analysis}
\author{}
\date{\vspace{-2.5em}2025-01-03}

\begin{document}
\maketitle

\hypertarget{r-markdown}{%
\subsection{R Markdown}\label{r-markdown}}

This is an R Markdown document. Markdown is a simple formatting syntax
for authoring HTML, PDF, and MS Word documents. For more details on
using R Markdown see \url{http://rmarkdown.rstudio.com}.

When you click the \textbf{Knit} button a document will be generated
that includes both content as well as the output of any embedded R code
chunks within the document. You can embed an R code chunk like this: \#
Dataset analysis

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_econ\_data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{\textquotesingle{}./Key\_Economic\_Indicators.csv\textquotesingle{}}\NormalTok{)}
\FunctionTok{colnames}\NormalTok{(all\_econ\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "Month"                                 
##  [2] "Year"                                  
##  [3] "Consumer.Confidence.Index.TX"          
##  [4] "Consumer.Confidence.West.South.Central"
##  [5] "Consumer.Confidence.Index.US"          
##  [6] "PCE.Deflator"                          
##  [7] "Consumer.Price.Index.TX"               
##  [8] "Consumer.Price.Index.U.S."             
##  [9] "CPI.U.S..Ex.Food.and.Energy"           
## [10] "Nonfarm.Employment.TX"                 
## [11] "Nonfarm.Employment.U.S."               
## [12] "Unemployment.TX"                       
## [13] "Unemployment.U.S."                     
## [14] "Single.Family.Building.Permits.TX"     
## [15] "Multi.Family.Building.Permits.TX"      
## [16] "Existing.Single.Family.Home.Sales.TX"  
## [17] "Existing.Single.Family.Home.Price.TX"  
## [18] "Non.Residential.Building.Construction" 
## [19] "Total.Sales.Tax.Collections.Retail.TX" 
## [20] "Total.Sales.Tax.Collections.TX"        
## [21] "Retail.Gasoline.Price.TX"              
## [22] "Retail.Diesel.Price.TX"                
## [23] "Nonfarm.Employment.Illinois"           
## [24] "Nonfarm.Employment.Florida"            
## [25] "Nonfarm.Employment.New.York"           
## [26] "Nonfarm.Employment.Texas"              
## [27] "Nonfarm.Employment.California"         
## [28] "Gross.Value.Crude.Oil.Production"      
## [29] "Gross.Value.Natural.Gas.Production"    
## [30] "Motor.Fuel.Taxed.Gasoline"             
## [31] "Motor.Fuel.Taxed.Diesel"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(all\_econ\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Month Year Consumer.Confidence.Index.TX
## 1     1 2005                           NA
## 2     2 2005                           NA
## 3     3 2005                           NA
## 4     4 2005                           NA
## 5     5 2005                           NA
## 6     6 2005                           NA
##   Consumer.Confidence.West.South.Central Consumer.Confidence.Index.US
## 1                                     NA                           NA
## 2                                     NA                           NA
## 3                                     NA                           NA
## 4                                     NA                           NA
## 5                                     NA                           NA
## 6                                     NA                           NA
##   PCE.Deflator Consumer.Price.Index.TX Consumer.Price.Index.U.S.
## 1           NA                      NA                        NA
## 2           NA                      NA                        NA
## 3           NA                      NA                        NA
## 4           NA                      NA                        NA
## 5           NA                      NA                        NA
## 6           NA                      NA                        NA
##   CPI.U.S..Ex.Food.and.Energy Nonfarm.Employment.TX Nonfarm.Employment.U.S.
## 1                          NA                    NA                      NA
## 2                          NA                    NA                      NA
## 3                          NA                    NA                      NA
## 4                          NA                    NA                      NA
## 5                          NA                    NA                      NA
## 6                          NA                    NA                      NA
##   Unemployment.TX Unemployment.U.S. Single.Family.Building.Permits.TX
## 1              NA                NA                                NA
## 2              NA                NA                                NA
## 3              NA                NA                                NA
## 4              NA                NA                                NA
## 5              NA                NA                                NA
## 6              NA                NA                                NA
##   Multi.Family.Building.Permits.TX Existing.Single.Family.Home.Sales.TX
## 1                               NA                                   NA
## 2                               NA                                   NA
## 3                               NA                                   NA
## 4                               NA                                   NA
## 5                               NA                                   NA
## 6                               NA                                   NA
##   Existing.Single.Family.Home.Price.TX Non.Residential.Building.Construction
## 1                                   NA                                    NA
## 2                                   NA                                    NA
## 3                                   NA                                    NA
## 4                                   NA                                    NA
## 5                                   NA                                    NA
## 6                                   NA                                    NA
##   Total.Sales.Tax.Collections.Retail.TX Total.Sales.Tax.Collections.TX
## 1                                    NA                             NA
## 2                                    NA                             NA
## 3                                    NA                             NA
## 4                                    NA                             NA
## 5                                    NA                             NA
## 6                                    NA                             NA
##   Retail.Gasoline.Price.TX Retail.Diesel.Price.TX Nonfarm.Employment.Illinois
## 1                    1.773                  1.906                      5829.6
## 2                    1.841                  1.958                      5836.2
## 3                    2.008                  2.148                      5833.8
## 4                    2.169                  2.226                      5857.5
## 5                    2.088                  2.150                      5855.4
## 6                    2.101                  2.256                      5841.0
##   Nonfarm.Employment.Florida Nonfarm.Employment.New.York
## 1                     7650.2                      8490.6
## 2                     7670.7                      8487.9
## 3                     7668.7                      8483.6
## 4                     7716.4                      8518.6
## 5                     7753.0                      8509.9
## 6                     7761.6                      8515.9
##   Nonfarm.Employment.Texas Nonfarm.Employment.California
## 1                   9642.4                       14881.8
## 2                   9653.2                       14908.3
## 3                   9670.8                       14929.3
## 4                   9715.1                       14979.4
## 5                   9727.1                       14985.4
## 6                   9734.0                       15000.9
##   Gross.Value.Crude.Oil.Production Gross.Value.Natural.Gas.Production
## 1                               NA                                 NA
## 2                               NA                                 NA
## 3                               NA                                 NA
## 4                               NA                                 NA
## 5                               NA                                 NA
## 6                               NA                                 NA
##   Motor.Fuel.Taxed.Gasoline Motor.Fuel.Taxed.Diesel
## 1                        NA                      NA
## 2                        NA                      NA
## 3                        NA                      NA
## 4                        NA                      NA
## 5                        NA                      NA
## 6                        NA                      NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load necessary library}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Arrange data by Year and Month for proper differencing}
\NormalTok{all\_econ\_data }\OtherTok{\textless{}{-}}\NormalTok{ all\_econ\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(Year, Month)}

\CommentTok{\# Calculate month{-}over{-}month differences for all numeric columns}
\CommentTok{\# Exclude \textquotesingle{}Year\textquotesingle{} and \textquotesingle{}Month\textquotesingle{} from differencing}
\NormalTok{data\_diff }\OtherTok{\textless{}{-}}\NormalTok{ all\_econ\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(Year, Month), }\SpecialCharTok{\textasciitilde{}}\NormalTok{ . }\SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(.), }\AttributeTok{.names =} \StringTok{"diff\_\{col\}"}\NormalTok{))}

\CommentTok{\# View the resulting dataset}
\FunctionTok{head}\NormalTok{(data\_diff)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Month Year Consumer.Confidence.Index.TX
## 1     1 2005                           NA
## 2     2 2005                           NA
## 3     3 2005                           NA
## 4     4 2005                           NA
## 5     5 2005                           NA
## 6     6 2005                           NA
##   Consumer.Confidence.West.South.Central Consumer.Confidence.Index.US
## 1                                     NA                           NA
## 2                                     NA                           NA
## 3                                     NA                           NA
## 4                                     NA                           NA
## 5                                     NA                           NA
## 6                                     NA                           NA
##   PCE.Deflator Consumer.Price.Index.TX Consumer.Price.Index.U.S.
## 1           NA                      NA                        NA
## 2           NA                      NA                        NA
## 3           NA                      NA                        NA
## 4           NA                      NA                        NA
## 5           NA                      NA                        NA
## 6           NA                      NA                        NA
##   CPI.U.S..Ex.Food.and.Energy Nonfarm.Employment.TX Nonfarm.Employment.U.S.
## 1                          NA                    NA                      NA
## 2                          NA                    NA                      NA
## 3                          NA                    NA                      NA
## 4                          NA                    NA                      NA
## 5                          NA                    NA                      NA
## 6                          NA                    NA                      NA
##   Unemployment.TX Unemployment.U.S. Single.Family.Building.Permits.TX
## 1              NA                NA                                NA
## 2              NA                NA                                NA
## 3              NA                NA                                NA
## 4              NA                NA                                NA
## 5              NA                NA                                NA
## 6              NA                NA                                NA
##   Multi.Family.Building.Permits.TX Existing.Single.Family.Home.Sales.TX
## 1                               NA                                   NA
## 2                               NA                                   NA
## 3                               NA                                   NA
## 4                               NA                                   NA
## 5                               NA                                   NA
## 6                               NA                                   NA
##   Existing.Single.Family.Home.Price.TX Non.Residential.Building.Construction
## 1                                   NA                                    NA
## 2                                   NA                                    NA
## 3                                   NA                                    NA
## 4                                   NA                                    NA
## 5                                   NA                                    NA
## 6                                   NA                                    NA
##   Total.Sales.Tax.Collections.Retail.TX Total.Sales.Tax.Collections.TX
## 1                                    NA                             NA
## 2                                    NA                             NA
## 3                                    NA                             NA
## 4                                    NA                             NA
## 5                                    NA                             NA
## 6                                    NA                             NA
##   Retail.Gasoline.Price.TX Retail.Diesel.Price.TX Nonfarm.Employment.Illinois
## 1                    1.773                  1.906                      5829.6
## 2                    1.841                  1.958                      5836.2
## 3                    2.008                  2.148                      5833.8
## 4                    2.169                  2.226                      5857.5
## 5                    2.088                  2.150                      5855.4
## 6                    2.101                  2.256                      5841.0
##   Nonfarm.Employment.Florida Nonfarm.Employment.New.York
## 1                     7650.2                      8490.6
## 2                     7670.7                      8487.9
## 3                     7668.7                      8483.6
## 4                     7716.4                      8518.6
## 5                     7753.0                      8509.9
## 6                     7761.6                      8515.9
##   Nonfarm.Employment.Texas Nonfarm.Employment.California
## 1                   9642.4                       14881.8
## 2                   9653.2                       14908.3
## 3                   9670.8                       14929.3
## 4                   9715.1                       14979.4
## 5                   9727.1                       14985.4
## 6                   9734.0                       15000.9
##   Gross.Value.Crude.Oil.Production Gross.Value.Natural.Gas.Production
## 1                               NA                                 NA
## 2                               NA                                 NA
## 3                               NA                                 NA
## 4                               NA                                 NA
## 5                               NA                                 NA
## 6                               NA                                 NA
##   Motor.Fuel.Taxed.Gasoline Motor.Fuel.Taxed.Diesel
## 1                        NA                      NA
## 2                        NA                      NA
## 3                        NA                      NA
## 4                        NA                      NA
## 5                        NA                      NA
## 6                        NA                      NA
##   diff_Consumer.Confidence.Index.TX diff_Consumer.Confidence.West.South.Central
## 1                                NA                                          NA
## 2                                NA                                          NA
## 3                                NA                                          NA
## 4                                NA                                          NA
## 5                                NA                                          NA
## 6                                NA                                          NA
##   diff_Consumer.Confidence.Index.US diff_PCE.Deflator
## 1                                NA                NA
## 2                                NA                NA
## 3                                NA                NA
## 4                                NA                NA
## 5                                NA                NA
## 6                                NA                NA
##   diff_Consumer.Price.Index.TX diff_Consumer.Price.Index.U.S.
## 1                           NA                             NA
## 2                           NA                             NA
## 3                           NA                             NA
## 4                           NA                             NA
## 5                           NA                             NA
## 6                           NA                             NA
##   diff_CPI.U.S..Ex.Food.and.Energy diff_Nonfarm.Employment.TX
## 1                               NA                         NA
## 2                               NA                         NA
## 3                               NA                         NA
## 4                               NA                         NA
## 5                               NA                         NA
## 6                               NA                         NA
##   diff_Nonfarm.Employment.U.S. diff_Unemployment.TX diff_Unemployment.U.S.
## 1                           NA                   NA                     NA
## 2                           NA                   NA                     NA
## 3                           NA                   NA                     NA
## 4                           NA                   NA                     NA
## 5                           NA                   NA                     NA
## 6                           NA                   NA                     NA
##   diff_Single.Family.Building.Permits.TX diff_Multi.Family.Building.Permits.TX
## 1                                     NA                                    NA
## 2                                     NA                                    NA
## 3                                     NA                                    NA
## 4                                     NA                                    NA
## 5                                     NA                                    NA
## 6                                     NA                                    NA
##   diff_Existing.Single.Family.Home.Sales.TX
## 1                                        NA
## 2                                        NA
## 3                                        NA
## 4                                        NA
## 5                                        NA
## 6                                        NA
##   diff_Existing.Single.Family.Home.Price.TX
## 1                                        NA
## 2                                        NA
## 3                                        NA
## 4                                        NA
## 5                                        NA
## 6                                        NA
##   diff_Non.Residential.Building.Construction
## 1                                         NA
## 2                                         NA
## 3                                         NA
## 4                                         NA
## 5                                         NA
## 6                                         NA
##   diff_Total.Sales.Tax.Collections.Retail.TX
## 1                                         NA
## 2                                         NA
## 3                                         NA
## 4                                         NA
## 5                                         NA
## 6                                         NA
##   diff_Total.Sales.Tax.Collections.TX diff_Retail.Gasoline.Price.TX
## 1                                  NA                            NA
## 2                                  NA                         0.068
## 3                                  NA                         0.167
## 4                                  NA                         0.161
## 5                                  NA                        -0.081
## 6                                  NA                         0.013
##   diff_Retail.Diesel.Price.TX diff_Nonfarm.Employment.Illinois
## 1                          NA                               NA
## 2                       0.052                              6.6
## 3                       0.190                             -2.4
## 4                       0.078                             23.7
## 5                      -0.076                             -2.1
## 6                       0.106                            -14.4
##   diff_Nonfarm.Employment.Florida diff_Nonfarm.Employment.New.York
## 1                              NA                               NA
## 2                            20.5                             -2.7
## 3                            -2.0                             -4.3
## 4                            47.7                             35.0
## 5                            36.6                             -8.7
## 6                             8.6                              6.0
##   diff_Nonfarm.Employment.Texas diff_Nonfarm.Employment.California
## 1                            NA                                 NA
## 2                          10.8                               26.5
## 3                          17.6                               21.0
## 4                          44.3                               50.1
## 5                          12.0                                6.0
## 6                           6.9                               15.5
##   diff_Gross.Value.Crude.Oil.Production diff_Gross.Value.Natural.Gas.Production
## 1                                    NA                                      NA
## 2                                    NA                                      NA
## 3                                    NA                                      NA
## 4                                    NA                                      NA
## 5                                    NA                                      NA
## 6                                    NA                                      NA
##   diff_Motor.Fuel.Taxed.Gasoline diff_Motor.Fuel.Taxed.Diesel
## 1                             NA                           NA
## 2                             NA                           NA
## 3                             NA                           NA
## 4                             NA                           NA
## 5                             NA                           NA
## 6                             NA                           NA
\end{verbatim}

\hypertarget{now-that-we-have-the-differences-compared-to-the-previous-month-as-well-as-the-original-values-lets-look-at-some-correlations.-i-have-chosen-the-cci-cpi-unemployment-rate-home-prices-and-energy-prices-as-the-target-variables-to-do-analysis-on.}{%
\paragraph{Now that we have the differences compared to the previous
month as well as the original values, lets look at some correlations. I
have chosen the CCI, CPI, Unemployment rate, Home prices, and Energy
prices as the target variables to do analysis
on.}\label{now-that-we-have-the-differences-compared-to-the-previous-month-as-well-as-the-original-values-lets-look-at-some-correlations.-i-have-chosen-the-cci-cpi-unemployment-rate-home-prices-and-energy-prices-as-the-target-variables-to-do-analysis-on.}}

\hypertarget{correlations}{%
\section{Correlations}\label{correlations}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(reshape2)}

\CommentTok{\# Assume your dataset is called \textquotesingle{}data\_diff\textquotesingle{} (with differenced values)}
\CommentTok{\# Specify your target variables}
\NormalTok{target\_vars }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Consumer.Confidence.Index.US"}\NormalTok{, }\StringTok{"Unemployment.TX"}\NormalTok{, }
                 \StringTok{"Existing.Single.Family.Home.Price.TX"}\NormalTok{, }
                 \StringTok{"Retail.Gasoline.Price.TX"}\NormalTok{, }
                 \StringTok{"Consumer.Price.Index.TX"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot\_correlation }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(target\_var, data, }\AttributeTok{threshold =} \DecValTok{0}\NormalTok{) \{}
  \CommentTok{\# Filter to remove NA values for the target variable}
\NormalTok{  filtered\_data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{select}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(target\_var), }\FunctionTok{everything}\NormalTok{())}
    
  
  \CommentTok{\# Calculate the correlation matrix}
\NormalTok{  cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(filtered\_data, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}
  
  \CommentTok{\# Convert correlation matrix to long format for filtering}
\NormalTok{  cor\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{as.table}\NormalTok{(cor\_matrix))}
  \FunctionTok{colnames}\NormalTok{(cor\_df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Var1"}\NormalTok{, }\StringTok{"Var2"}\NormalTok{, }\StringTok{"Correlation"}\NormalTok{)}
  
  \CommentTok{\# Filter correlations by threshold}
\NormalTok{  cor\_df }\OtherTok{\textless{}{-}}\NormalTok{ cor\_df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{filter}\NormalTok{(Var1 }\SpecialCharTok{==}\NormalTok{ target\_var }\SpecialCharTok{\&} \FunctionTok{abs}\NormalTok{(Correlation) }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(}\FunctionTok{abs}\NormalTok{(Correlation)))}
  
  \CommentTok{\# Create the plot}
  \FunctionTok{ggplot}\NormalTok{(cor\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Var2, }\AttributeTok{y =}\NormalTok{ Correlation, }\AttributeTok{fill =}\NormalTok{ Correlation)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_gradient2}\NormalTok{(}\AttributeTok{low =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{mid =} \StringTok{"white"}\NormalTok{, }\AttributeTok{high =} \StringTok{"red"}\NormalTok{, }\AttributeTok{midpoint =} \DecValTok{0}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Significant Correlations for"}\NormalTok{, target\_var)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} \CommentTok{\# Rotate x{-}axis labels}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{"Variables"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"Correlation"}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Generate plots for each target variable}
\NormalTok{plots }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (target }\ControlFlowTok{in}\NormalTok{ target\_vars) \{}
\NormalTok{  plots[[target]] }\OtherTok{\textless{}{-}} \FunctionTok{plot\_correlation}\NormalTok{(target, data\_diff)}
\NormalTok{\}}

\CommentTok{\# Print all plots}
\ControlFlowTok{for}\NormalTok{ (plot\_name }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(plots)) \{}
  \FunctionTok{print}\NormalTok{(plots[[plot\_name]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-4-1.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-4-2.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-4-3.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-4-4.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-4-5.pdf}
\#\#\#\# There are clearly a lot of variables here and as a result the
graph look quite clustered up. To get a better visualization lets limit
it so that variables only variables with abs(corr) \textgreater{} .2
show up. This helps us better see which variables are most correlated

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plots }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (target }\ControlFlowTok{in}\NormalTok{ target\_vars) \{}
\NormalTok{  plots[[target]] }\OtherTok{\textless{}{-}} \FunctionTok{plot\_correlation}\NormalTok{(target, data\_diff, .}\DecValTok{3}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Print all plots}
\ControlFlowTok{for}\NormalTok{ (plot\_name }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(plots)) \{}
  \FunctionTok{print}\NormalTok{(plots[[plot\_name]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-5-1.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-5-2.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-5-3.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-5-4.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-5-5.pdf}
\#\#\#\# This is much better for our visualization but maybe lets order
it by the magnitude of the correlation to better see which specific ones
are important for each target variable

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot\_correlation }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(target\_var, data, }\AttributeTok{threshold =} \DecValTok{0}\NormalTok{) \{}
  \CommentTok{\# Filter to remove NA values for the target variable}
\NormalTok{  filtered\_data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{select}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(target\_var), }\FunctionTok{everything}\NormalTok{())}
    
  
  \CommentTok{\# Calculate the correlation matrix}
\NormalTok{  cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(filtered\_data, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}
  
  \CommentTok{\# Convert correlation matrix to long format for filtering}
\NormalTok{  cor\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{as.table}\NormalTok{(cor\_matrix))}
  \FunctionTok{colnames}\NormalTok{(cor\_df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Var1"}\NormalTok{, }\StringTok{"Var2"}\NormalTok{, }\StringTok{"Correlation"}\NormalTok{)}
  
  \CommentTok{\# Filter correlations by threshold}
\NormalTok{  cor\_df }\OtherTok{\textless{}{-}}\NormalTok{ cor\_df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{filter}\NormalTok{(Var1 }\SpecialCharTok{==}\NormalTok{ target\_var }\SpecialCharTok{\&} \FunctionTok{abs}\NormalTok{(Correlation) }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold }\SpecialCharTok{\&}\NormalTok{ Var2 }\SpecialCharTok{!=}\NormalTok{ target\_var) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Correlation))}
  
  \CommentTok{\# Reorder Var2 for plotting}
\NormalTok{  cor\_df}\SpecialCharTok{$}\NormalTok{Var2 }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(cor\_df}\SpecialCharTok{$}\NormalTok{Var2, }\AttributeTok{levels =}\NormalTok{ cor\_df}\SpecialCharTok{$}\NormalTok{Var2)}
  
  \CommentTok{\# Create the plot}
  \FunctionTok{ggplot}\NormalTok{(cor\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Var2, }\AttributeTok{y =}\NormalTok{ Correlation, }\AttributeTok{fill =}\NormalTok{ Correlation)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_gradient2}\NormalTok{(}\AttributeTok{low =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{mid =} \StringTok{"white"}\NormalTok{, }\AttributeTok{high =} \StringTok{"red"}\NormalTok{, }\AttributeTok{midpoint =} \DecValTok{0}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{ggtitle}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Significant Correlations for"}\NormalTok{, target\_var)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} \CommentTok{\# Rotate x{-}axis labels}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{"Variables"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"Correlation"}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Generate plots for each target variable}
\NormalTok{plots }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (target }\ControlFlowTok{in}\NormalTok{ target\_vars) \{}
\NormalTok{  plots[[target]] }\OtherTok{\textless{}{-}} \FunctionTok{plot\_correlation}\NormalTok{(target, all\_econ\_data, .}\DecValTok{3}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Print all plots}
\ControlFlowTok{for}\NormalTok{ (plot\_name }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(plots)) \{}
  \FunctionTok{print}\NormalTok{(plots[[plot\_name]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-6-1.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-6-2.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-6-3.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-6-4.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-6-5.pdf}
\#\# Correlation with Year \#\#\#\# I clearly overlooked the Year
variable in these correlations and did not take it out but it appears as
a significant correlator to 3 out of 5 of the target variables. So out
of curiosity lets graph each of them as compred to their average value
for that year.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'tidyr'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:reshape2':
## 
##     smiths
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{yearly\_avg }\OtherTok{\textless{}{-}}\NormalTok{ all\_econ\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(target\_vars), mean, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Year, }\AttributeTok{names\_to =} \StringTok{"Variable"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"Average"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There was 1 warning in `summarise()`.
## i In argument: `across(all_of(target_vars), mean, na.rm = TRUE)`.
## i In group 1: `Year = 2005`.
## Caused by warning:
## ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
## Supply arguments directly to `.fns` through an anonymous function instead.
## 
##   # Previously
##   across(a:b, mean, na.rm = TRUE)
## 
##   # Now
##   across(a:b, \(x) mean(x, na.rm = TRUE))
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot yearly averages for each target variable}
\FunctionTok{ggplot}\NormalTok{(yearly\_avg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Year, }\AttributeTok{y =}\NormalTok{ Average, }\AttributeTok{color =}\NormalTok{ Variable, }\AttributeTok{group =}\NormalTok{ Variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Yearly Averages of Target Variables"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Year"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Average Value"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Variable"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{verbatim}
## Warning: Removed 13 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 13 rows containing missing values or values outside the scale range
## (`geom_point()`).
\end{verbatim}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-7-1.pdf}
\#\#\#\# Although this might make it seem like only the house prices
have a true correlation, I belive this is because house prices are huge
compared to the other variables. So how about lets standardize the
values in each each column so that we can better see this change through
the years

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Standardize the target variables}
\NormalTok{all\_econ\_data\_standardized }\OtherTok{\textless{}{-}}\NormalTok{ all\_econ\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{all\_of}\NormalTok{(target\_vars), }\SpecialCharTok{\textasciitilde{}}\NormalTok{ (.}\SpecialCharTok{{-}}\FunctionTok{mean}\NormalTok{(., }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} \FunctionTok{sd}\NormalTok{(., }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
                \AttributeTok{.names =} \StringTok{"std\_\{col\}"}\NormalTok{))}

\CommentTok{\# Calculate yearly averages for standardized variables}
\NormalTok{yearly\_avg\_std }\OtherTok{\textless{}{-}}\NormalTok{ all\_econ\_data\_standardized }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"std\_"}\NormalTok{), mean, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Year, }\AttributeTok{names\_to =} \StringTok{"Variable"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"Average"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Variable =} \FunctionTok{gsub}\NormalTok{(}\StringTok{"std\_"}\NormalTok{, }\StringTok{""}\NormalTok{, Variable))  }\CommentTok{\# Clean variable names for plot}

\CommentTok{\# Plot yearly averages for standardized variables}
\FunctionTok{ggplot}\NormalTok{(yearly\_avg\_std, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Year, }\AttributeTok{y =}\NormalTok{ Average, }\AttributeTok{color =}\NormalTok{ Variable, }\AttributeTok{group =}\NormalTok{ Variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Yearly Averages of Standardized Target Variables"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Year"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Standardized Average (z{-}scores)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Variable"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 13 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 13 rows containing missing values or values outside the scale range
## (`geom_point()`).
\end{verbatim}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-8-1.pdf}
\#\#\#\# Well it does make sense that house prices and the CPI would
increase with the years and it can also be seen here on the graph. But
it still doesn't make sense why unemployment a correlation because it
seems like most of them fluctuate through the years.And it intuitively
makes sense because the unemployment rate and CCI should fluctuate as
they fluctuate with the economy, but I guess gasoline prices also
fluctuates and from what we see on the graph it moves quite similarly to
the unemployment rate.

\hypertarget{pca}{%
\section{PCA}\label{pca}}

\hypertarget{another-way-to-look-at-correlations-is-to-perform-pca-and-extract-the-variables-that-seem-to-contribute-the-most-to-the-variance-in-the-target-variables-hence-the-ones-that-have-the-largest-impact-on-the-target-variable.-to-make-things-a-bit-simpler-i-will-only-vizualize-the-first-2-pcs-but-these-2-should-be-able-to-explain-majority-of-the-variance-in-the-dataset.-also-just-like-before-in-order-to-avoid-a-cluster-of-all-the-features-i-will-only-consider-features-that-have-a-correlation-higher-than-a-specified-threshold-starting-with-threshold0.3}{%
\paragraph{Another way to look at correlations is to perform PCA and
extract the variables that seem to contribute the most to the variance
in the target variables hence the ones that have the largest impact on
the target variable. To make things a bit simpler I will only vizualize
the first 2 PCs but these 2 should be able to explain majority of the
variance in the dataset. Also just like before in order to avoid a
cluster of all the features I will only consider features that have a
correlation higher than a specified threshold starting with
threshold=0.3}\label{another-way-to-look-at-correlations-is-to-perform-pca-and-extract-the-variables-that-seem-to-contribute-the-most-to-the-variance-in-the-target-variables-hence-the-ones-that-have-the-largest-impact-on-the-target-variable.-to-make-things-a-bit-simpler-i-will-only-vizualize-the-first-2-pcs-but-these-2-should-be-able-to-explain-majority-of-the-variance-in-the-dataset.-also-just-like-before-in-order-to-avoid-a-cluster-of-all-the-features-i-will-only-consider-features-that-have-a-correlation-higher-than-a-specified-threshold-starting-with-threshold0.3}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(factoextra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'factoextra' was built under R version 4.3.3
\end{verbatim}

\begin{verbatim}
## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{perform\_pca\_with\_inline\_visualization }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, target\_vars, }\AttributeTok{cor\_threshold =} \FloatTok{0.5}\NormalTok{) \{}
  \CommentTok{\# Initialize a list to store PCA results for each target variable}
\NormalTok{  pca\_results }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
  
  \ControlFlowTok{for}\NormalTok{ (target\_var }\ControlFlowTok{in}\NormalTok{ target\_vars) \{}
    
    \CommentTok{\# Subset data for pairwise complete cases with the target variable}
\NormalTok{    target\_data }\OtherTok{\textless{}{-}}\NormalTok{ data[, }\FunctionTok{c}\NormalTok{(target\_var, }\FunctionTok{setdiff}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(data), target\_vars))]}
    
    \CommentTok{\# Compute the correlation matrix using pairwise.complete.obs}
\NormalTok{    cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(target\_data, }\AttributeTok{use =} \StringTok{"pairwise.complete.obs"}\NormalTok{)}
    
    \CommentTok{\# Filter variables based on correlation threshold with the target variable}
\NormalTok{    target\_correlations }\OtherTok{\textless{}{-}}\NormalTok{ cor\_matrix[, target\_var, drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]  }\CommentTok{\# Correlations with the target variable}
\NormalTok{    vars\_to\_include }\OtherTok{\textless{}{-}} \FunctionTok{rownames}\NormalTok{(target\_correlations)[}\FunctionTok{abs}\NormalTok{(target\_correlations[, }\DecValTok{1}\NormalTok{]) }\SpecialCharTok{\textgreater{}=}\NormalTok{ cor\_threshold]}
\NormalTok{    vars\_to\_include }\OtherTok{\textless{}{-}} \FunctionTok{setdiff}\NormalTok{(vars\_to\_include, target\_var)}

    
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(vars\_to\_include) }\SpecialCharTok{\textless{}} \DecValTok{2}\NormalTok{) \{}
      \FunctionTok{warning}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Not enough variables meet the correlation threshold for"}\NormalTok{, target\_var, }\StringTok{". Skipping PCA."}\NormalTok{))}
      \ControlFlowTok{next}
\NormalTok{    \}}
    
    \CommentTok{\# Subset the correlation matrix to include only selected variables}
\NormalTok{    filtered\_cor\_matrix }\OtherTok{\textless{}{-}}\NormalTok{ cor\_matrix[vars\_to\_include, vars\_to\_include]}
    
    \CommentTok{\# Perform PCA on the filtered correlation matrix}
\NormalTok{    pca\_result }\OtherTok{\textless{}{-}} \FunctionTok{prcomp}\NormalTok{(filtered\_cor\_matrix, }\AttributeTok{scale. =} \ConstantTok{FALSE}\NormalTok{)}
    
    \CommentTok{\# Store the PCA result in the list}
\NormalTok{    pca\_results[[target\_var]] }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
      \AttributeTok{pca =}\NormalTok{ pca\_result,}
      \AttributeTok{explained\_variance =} \FunctionTok{summary}\NormalTok{(pca\_result)}\SpecialCharTok{$}\NormalTok{importance[}\DecValTok{2}\NormalTok{, ] }\CommentTok{\# Proportion of variance explained}
\NormalTok{    )}
    
    \CommentTok{\# Visualization}
\NormalTok{    plot\_title }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"PCA for"}\NormalTok{, target\_var, }\StringTok{"(Cor threshold:"}\NormalTok{, cor\_threshold, }\StringTok{")"}\NormalTok{)}
\NormalTok{    pca\_plot }\OtherTok{\textless{}{-}} \FunctionTok{fviz\_pca\_var}\NormalTok{(}
\NormalTok{      pca\_result,}
      \AttributeTok{title =}\NormalTok{ plot\_title,}
      \AttributeTok{repel =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{col.var =} \StringTok{"cos2"}\NormalTok{, }\CommentTok{\# Coloring by contribution}
      \AttributeTok{gradient.cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#00AFBB"}\NormalTok{, }\StringTok{"\#E7B800"}\NormalTok{, }\StringTok{"\#FC4E07"}\NormalTok{)}
\NormalTok{    )}
    
    \CommentTok{\# Print the plot inline}
    \FunctionTok{print}\NormalTok{(pca\_plot)}
\NormalTok{  \}}
  
  \FunctionTok{return}\NormalTok{(pca\_results)}
\NormalTok{\}}

\CommentTok{\# Example usage with a correlation threshold of 0.6}
\NormalTok{pca\_results }\OtherTok{\textless{}{-}} \FunctionTok{perform\_pca\_with\_inline\_visualization}\NormalTok{(all\_econ\_data, target\_vars, }\AttributeTok{cor\_threshold =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-9-1.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-9-2.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-9-3.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-9-4.pdf}
\includegraphics{Economic-Indicators-analysis_files/figure-latex/unnamed-chunk-9-5.pdf}
Let's analyze CCI Index's Principal Component(PC) graph as it has many
features still left on the graph whilst not being as clustered as the
other ones. We see 2 principal components on the graph with PC1 being on
the Y axis and PC2 being on the x axis. For CCI PC1 explains 83.5\% of
the variance and PC2 explains 12.7\% as is shown by the x and y axis
labels on the graphs meaning together they explain 76.6+12.4=96.2\% of
the variance seen in the CCI for Texas. We can also see that the
Unemployment rate in US contributes positively to both of these PCs'
values as it appears in the first quadrant meaning it has a positive
component for both PCs. Similarly all the features appearing in the 3rd
quadrant of this PCA graph all contribute negatively to both of the PCs'
values. On this graph we can also see that features that have high
positive correlation with each other tend to have smaller angles(close
to 0) between their component lines and features with high negative
correlation tend to point in the opposite directions(180 degrees between
them). For example all the Nonfarm Employment vectors have a very small
angle between them and it makes sense that they would all be highly
correlated with each other.

\end{document}
